{% extends "_base.html" %}
{% set title = "Diary" %}

{% block content %}
  <div class="pt-6 flex items-center justify-between">
    <div class="font-semibold text-lg">Diary</div>
    <a href="/dashboard" class="text-slate-400 text-sm">Back</a>
  </div>

  <div class="mt-4 bg-card border border-border rounded-3xl p-5">
    <form class="flex items-center justify-between gap-3" method="get" action="/diary">
      <input type="date" name="date" value="{{ date }}" class="bg-card2 border border-border rounded-2xl px-4 py-3 outline-none w-full" />
      <button class="px-4 py-3 rounded-2xl bg-white text-bg font-semibold">Go</button>
    </form>

    <div class="mt-4 grid grid-cols-2 gap-3">
      <div class="bg-card2 border border-border rounded-3xl p-4">
        <div class="text-slate-400 text-sm">Calories</div>
        <div class="text-3xl font-semibold mt-1">{{ totals.calories | round(0) | int }}</div>
      </div>
      <div class="bg-card2 border border-border rounded-3xl p-4">
        <div class="text-slate-400 text-sm">Water</div>
        <div class="text-3xl font-semibold mt-1">{{ totals.water_ml | default(0) }}ml</div>
      </div>
    </div>

    <div class="mt-3 grid grid-cols-3 gap-3">
      <div class="bg-card2 border border-border rounded-3xl p-4"><div class="text-slate-400 text-sm">Protein</div><div class="text-xl font-semibold mt-1">{{ totals.protein | round(0) | int }}g</div></div>
      <div class="bg-card2 border border-border rounded-3xl p-4"><div class="text-slate-400 text-sm">Carbs</div><div class="text-xl font-semibold mt-1">{{ totals.carbs | round(0) | int }}g</div></div>
      <div class="bg-card2 border border-border rounded-3xl p-4"><div class="text-slate-400 text-sm">Fat</div><div class="text-xl font-semibold mt-1">{{ totals.fat | round(0) | int }}g</div></div>
    </div>

    <div class="mt-6">
      <div class="font-semibold">Food logs</div>
      <div class="mt-3 space-y-3">
        {% for log in logs %}
          <div class="bg-card2 border border-border rounded-3xl p-4">
            <div class="flex justify-between items-start gap-3">
              <div>
                <div class="font-semibold">{{ log.product_name }}</div>
                <div class="text-slate-400 text-sm mt-1">ðŸ”¥ {{ log.calories | round(0) | int }} kcal â€¢ P {{ log.protein | round(0) | int }} â€¢ C {{ log.carbs | round(0) | int }} â€¢ F {{ log.fat | round(0) | int }}</div>
              </div>
              <div class="text-xs text-slate-500">{{ log.source }}</div>
            </div>
          </div>
        {% else %}
          <div class="text-slate-400 text-sm">No food logs for this date.</div>
        {% endfor %}
      </div>
    </div>

    <div class="mt-6">
      <div class="font-semibold">Water logs</div>
      <div class="mt-3 space-y-3">
        {% for w in water_logs %}
          <div class="bg-card2 border border-border rounded-3xl p-4 flex items-center justify-between">
            <div class="text-slate-300">+ {{ w.amount_ml }} ml</div>
            <div class="text-xs text-slate-500">{{ w.created_at[11:16] if w.created_at else "" }}</div>
          </div>
        {% else %}
          <div class="text-slate-400 text-sm">No water logs for this date.</div>
        {% endfor %}
      </div>
    </div>

    <div class="mt-6 grid grid-cols-2 gap-3">
      <a href="/scan" class="py-3 rounded-2xl bg-white text-bg font-semibold text-center">Scan food</a>
      <a href="/meal" class="py-3 rounded-2xl bg-card2 border border-border text-slate-200 font-semibold text-center">Log meal</a>
    </div>
  </div>
{% endblock %}
